# CreatingPipelinesUsingSDK

# 0) Set/verify version (PowerShell uses $env:, not %VAR%)
$env:PIPELINE_VERSION = "2.14.0"
echo $env:PIPELINE_VERSION   # should print 2.14.0

# Helper for the ref string so you donâ€™t mistype it
$ref = "?ref=$($env:PIPELINE_VERSION)"

# 1) Create the namespace (idempotent)
kubectl create namespace kubeflow --dry-run=client -o yaml | kubectl apply -f -

# 2) Install cluster-scoped resources (CRDs, RBAC, etc.) FIRST
kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/cluster-scoped-resources$ref"

# 3) Wait for the key CRD to register (prevents the 'Application' not found error)
kubectl wait --for=condition=Established crd/applications.app.k8s.io --timeout=120s

# 4) Install the KFP deployment (pick ONE overlay; platform-agnostic is a safe default)
kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/env/platform-agnostic$ref"
# (Alternative: env/dev)
# kubectl apply -k "github.com/kubeflow/pipelines/manifests/kustomize/env/dev$ref"

# 5) Watch things come up
kubectl -n kubeflow get deploy,po,svc
